!function(){var e,t,n;!function(i){function o(e,t){return y.call(e,t)}function s(e,t){var n,i,o,s,r,a,l,d,c,m,f,u=t&&t.split("/"),h=v.map,p=h&&h["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=e.split("/"),r=e.length-1,v.nodeIdCompat&&j.test(e[r])&&(e[r]=e[r].replace(j,"")),e=u.slice(0,u.length-1).concat(e),c=0;c<e.length;c+=1)if("."===(f=e[c]))e.splice(c,1),c-=1;else if(".."===f){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((u||p)&&h){for(n=e.split("/"),c=n.length;c>0;c-=1){if(i=n.slice(0,c).join("/"),u)for(m=u.length;m>0;m-=1)if((o=h[u.slice(0,m).join("/")])&&(o=o[i])){s=o,a=c;break}if(s)break;!l&&p&&p[i]&&(l=p[i],d=c)}!s&&l&&(s=l,a=d),s&&(n.splice(0,a,s),e=n.join("/"))}return e}function r(e,t){return function(){var n=C.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),u.apply(i,n.concat([e,t]))}}function a(e){return function(t){return s(t,e)}}function l(e){return function(t){w[e]=t}}function d(e){if(o(g,e)){var t=g[e];delete g[e],b[e]=!0,f.apply(i,t)}if(!o(w,e)&&!o(b,e))throw new Error("No "+e);return w[e]}function c(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function m(e){return function(){return v&&v.config&&v.config[e]||{}}}var f,u,h,p,w={},g={},v={},b={},y=Object.prototype.hasOwnProperty,C=[].slice,j=/\.js$/;h=function(e,t){var n,i=c(e),o=i[0];return e=i[1],o&&(o=s(o,t),n=d(o)),o?e=n&&n.normalize?n.normalize(e,a(t)):s(e,t):(e=s(e,t),i=c(e),o=i[0],e=i[1],o&&(n=d(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:n}},p={require:function(e){return r(e)},exports:function(e){var t=w[e];return void 0!==t?t:w[e]={}},module:function(e){return{id:e,uri:"",exports:w[e],config:m(e)}}},f=function(e,t,n,s){var a,c,m,f,u,v,y=[],C=typeof n;if(s=s||e,"undefined"===C||"function"===C){for(t=!t.length&&n.length?["require","exports","module"]:t,u=0;u<t.length;u+=1)if(f=h(t[u],s),"require"===(c=f.f))y[u]=p.require(e);else if("exports"===c)y[u]=p.exports(e),v=!0;else if("module"===c)a=y[u]=p.module(e);else if(o(w,c)||o(g,c)||o(b,c))y[u]=d(c);else{if(!f.p)throw new Error(e+" missing "+c);f.p.load(f.n,r(s,!0),l(c),{}),y[u]=w[c]}m=n?n.apply(w[e],y):void 0,e&&(a&&a.exports!==i&&a.exports!==w[e]?w[e]=a.exports:m===i&&v||(w[e]=m))}else e&&(w[e]=n)},e=t=u=function(e,t,n,o,s){if("string"==typeof e)return p[e]?p[e](t):d(h(e,t).f);if(!e.splice){if(v=e,v.deps&&u(v.deps,v.callback),!t)return;t.splice?(e=t,t=n,n=null):e=i}return t=t||function(){},"function"==typeof n&&(n=o,o=s),o?f(i,e,t,n):setTimeout(function(){f(i,e,t,n)},4),u},u.config=function(e){return u(e)},e._defined=w,n=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),o(w,e)||o(g,e)||(g[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("../../assets/js/lib/almond",function(){}),n("models/formModel",[],function(){return Backbone.Model.extend({defaults:{objectType:"form",id:0,title:"unknown",created_at:"unknown"},url:function(){return ajaxurl+"?action=nf_forms&form_id="+this.get("id")},initialize:function(){this.set("id",Number(this.get("id"))),this.get("id")&&this.initShortcode(this.get("id")),this.get("title")&&this.set("title",this.get("title").replace(/<\/?[^>]+(>|$)/g,""))},initShortcode:function(e){var t="[ninja_form id="+e+"]";this.set("shortcode",t)},destroy:function(){var e=this;jQuery.ajax({type:"POST",url:ajaxurl+"?action=nf_forms&method_override=delete&form_id="+this.get("id"),success:function(t){var t=JSON.parse(t);e.collection.remove(e)}})}})}),n("models/formCollection",["models/formModel"],function(e){return Backbone.Collection.extend({model:e,comparator:"title",tmpNum:1,url:function(){return ajaxurl+"?action=nf_forms"},initialize:function(){this.newIDs=[],this.baseUrl=window.location.href.split("?")[0],this.listenTo(i.channel("dashboard"),"forms:delete",this.modalConfirm),this.listenTo(i.channel("dashboard"),"forms:duplicate",this.duplicate),this.modal=new jBox("Modal",{width:400,addClass:"dashboard-modal",overlay:!0,closeOnClick:"body"})},parse:function(e,t){return e.data},modalConfirm:function(e){var t,n,i,o,s,r,a,l=e.model.get("id"),d=e.model.get("title");n=document.createElement("div"),n.style.paddingRight="20px",n.style.paddingLeft="20px",n.style.paddingBottom="20px",i=document.createElement("p"),o=document.createElement("em"),s=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),n.classList.add("message"),o.innerHTML=d,i.innerHTML+=nfi18n.deleteWarningA+" (<strong>"+d+"</strong>). "+nfi18n.deleteWarningB,i.appendChild(document.createElement("br")),i.appendChild(document.createElement("br"));var c=document.createElement("a");c.href=this.baseUrl+"?page=nf-import-export&exportFormId="+l,c.innerHTML='<i class="fa fa-download" style="padding:5px;"></i>'+nfi18n.deleteXForm,c.target="_blank",i.appendChild(c),i.appendChild(document.createElement("br"));var m=document.createElement("a");m.href=this.baseUrl+"?page=nf-processing&action=download_all_subs&form_id="+l+"&redirect="+encodeURIComponent(this.baseUrl.replace("admin.php","edit.php")+"?post_status=all&post_type=nf_sub&form_id="+l),m.target="_blank",m.innerHTML='<i class="fa fa-download" style="padding:5px;"></i>'+nfi18n.deleteXSubs,i.appendChild(m),i.appendChild(document.createElement("br")),n.appendChild(i);var f=document.createElement("label");f.for="confirmDeleteFormInput",f.innerHTML=nfi18n.deleteConfirmA+' <span style="color:red;">DELETE</span> '+nfi18n.deleteConfirmB;var u=document.createElement("input");u.type="text",u.id="confirmDeleteFormInput",u.style.marginTop="10px",u.style.width="100%",u.style.height="2.5em",u.style.fontSize="1em",n.appendChild(f),n.appendChild(document.createElement("br")),n.appendChild(u),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),r.innerHTML=nfi18n.delete,r.classList.add("confirm","nf-button","primary","pull-right"),a.innerHTML=nfi18n.cancel,a.classList.add("cancel","nf-button","secondary"),s.appendChild(a),s.appendChild(r),s.classList.add("buttons"),n.appendChild(s),t=document.createElement("div"),t.appendChild(n),this.modal.setContent(t.innerHTML),this.modal.setTitle(nfi18n.deleteTitle),this.modal.open();var h=this;this.modal.container[0].getElementsByClassName("cancel")[0].addEventListener("click",function(){h.modalClose()}),this.modal.container[0].getElementsByClassName("confirm")[0].addEventListener("click",function(){"DELETE"===document.getElementById("confirmDeleteFormInput").value?h.confirmDelete(e):h.modalClose()})},modalClose:function(){this.modal.close()},confirmDelete:function(e){jQuery(e.el).removeClass("show-actions"),jQuery(e.el).addClass("deleting"),jQuery(e.el).animate({opacity:0,"line-height":0,display:"none"},500),console.log(e),e.model.destroy(),this.modalClose()},duplicate:function(e){var t='<div class="message">Duplicating <em>'+e.model.get("title")+'</em>...<div class="nf-loading-spinner"></div></div>';this.modal.setContent(t),this.modal.setTitle("Please Wait"),this.modal.open();var n=this;jQuery.ajax({type:"POST",url:ajaxurl+"?action=nf_forms&clone_id="+e.model.get("id"),success:function(t){var t=JSON.parse(t),i=t.data.new_form_id,o=e.model.clone();o.set({id:i,title:o.get("title")+" - copy",created_at:new Date}),o.initShortcode(i),e.model.collection.add(o),n.modalClose()}})}})}),n("controllers/formsController",["models/formModel","models/formCollection"],function(e,t){return Marionette.Object.extend({initialize:function(){this.forms=new t,i.channel("dashboard").reply("get:forms",this.getForms,this),this.forms.fetch({success:function(e){i.channel("dashboard").trigger("fetch:forms",e)}})},getForms:function(){return this.forms}})}),n("views/widgets/forms/formsFilter",[],function(){return Marionette.View.extend({template:"#tmpl-nf-widget-forms-filter",ui:{input:"input"},events:{"keyup @ui.input":"updateFilter"},initialize:function(){this.listenTo(i.channel("widget-forms"),"change:content",this.clearFilter)},updateFilter:function(){var e=this.getUI("input").val();i.channel("widget-forms").trigger("update:filter",e)},clearFilter:function(){this.getUI("input").val("")},updatePlaceholder:function(e){this.getUI("input").attr("placeholder",e)}})}),n("views/widgets/forms/formsTableRow",[],function(){return Marionette.View.extend({template:"#tmpl-nf-widget-forms-table-row",tagName:"tr",replaceElement:!0,ui:{delete:".delete",duplicate:".duplicate",edit:".nf-item-edit"},events:{"click @ui.delete":function(){i.channel("dashboard").trigger("forms:delete",this)},"click @ui.duplicate":function(){i.channel("dashboard").trigger("forms:duplicate",this)},"click @ui.edit":function(e){this.$el.toggleClass("show-actions").siblings().removeClass("show-actions")}},templateContext:function(){var e=this.model;return{created_at:moment(e.get("created_at")).format("MM/DD/YY h:mm A")}}})}),n("views/widgets/forms/formsTableEmpty",[],function(){return Marionette.View.extend({template:"#tmpl-nf-widget-forms-table-empty",tagName:"tr"})}),n("views/widgets/forms/formsTableBody",["views/widgets/forms/formsTableRow","views/widgets/forms/formsTableEmpty"],function(e,t){return Marionette.CollectionView.extend({childView:e,emptyView:t,className:"forms-collection",tagName:"tbody",initialize:function(){this.listenTo(i.channel("widget-forms"),"update:filter",this.updateFilter)},updateFilter:function(e){this.setFilter(function(t,n,i){return 0<=t.get("title").toLowerCase().indexOf(e.toLowerCase())})}})}),n("views/widgets/forms/formsTableLoading",[],function(){return Marionette.View.extend({template:"#tmpl-nf-widget-forms-table-loading",tagName:"tr"})}),n("views/widgets/forms/formsTable",["views/widgets/forms/formsTableBody","views/widgets/forms/formsTableLoading","models/formCollection"],function(e,t,n){return Marionette.View.extend({template:"#tmpl-nf-widget-forms-table",className:"nf-table-display",tagName:"table",initialize:function(){var t=this;this.listenTo(i.channel("dashboard"),"fetch:forms",function(n){t.showChildView("body",new e({collection:n}))})},regions:{body:{el:"tbody",replaceElement:!0}},ui:{sortable:".sortable",body:"tbody",action2:".action2",more:".more",less:".less"},onRender:function(){this.getUI("less").hide();var n=i.channel("dashboard").request("get:forms");void 0===n?this.showChildView("body",new t):this.showChildView("body",new e({collection:n})),this.maybeHideMoreButton()},events:{"click @ui.sortable":"sortFormsTable","click @ui.more":"showMore","click @ui.less":"showLess"},sortFormsTable:function(e){this.getUI("sortable").removeClass("sorted-asc"),this.getUI("sortable").removeClass("sorted-desc");var t=jQuery(e.target).data("sort"),n=jQuery(e.target).data("reverse")||0;n?(jQuery(e.target).addClass("sorted-desc"),jQuery(e.target).removeClass("sorted-asc")):(jQuery(e.target).addClass("sorted-asc"),jQuery(e.target).removeClass("sorted-desc"));var i=this.getChildView("body").collection;i.comparator=function(e,i){return name1=e.get(t).toLowerCase(),name2=i.get(t).toLowerCase(),name1<name2?ret=-1:name1>name2?ret=1:ret=0,n&&(ret=-ret),ret},i.sort(),n?(i.models.reverse(),jQuery(e.target).data("reverse",0)):jQuery(e.target).data("reverse",1)},showMore:function(){this.getUI("more").hide(),this.getUI("less").show(),this.getUI("body").addClass("more")},showLess:function(){this.getUI("less").hide(),this.getUI("more").show(),this.getUI("body").removeClass("more")},maybeHideMoreButton:function(){void 0!==this.collection&&10<this.collection.length||this.getUI("action2").hide()}})}),n("models/formTemplateModel",[],function(){return Backbone.Model.extend({defaults:{objectType:"template",id:"none",title:"unknown"},initialize:function(){this.set("desc",this.get("template-desc"))}})}),n("models/formTemplateCollection",["models/formTemplateModel"],function(e){return Backbone.Collection.extend({model:e,tmpNum:1,url:function(){return ajaxurl+"?action=nf_new_form_templates"},parse:function(e,t){return e.data},initialize:function(){this.fetch({success:function(e){},error:function(e){}})}})}),n("views/widgets/forms/newFormTemplate",[],function(){return Marionette.View.extend({template:"#tmpl-nf-widget-forms-template"})}),n("views/widgets/forms/newFormGrid",["models/formTemplateCollection","views/widgets/forms/newFormTemplate"],function(e,t){return Marionette.CollectionView.extend({tagName:"div",className:"template-list",collection:new e,childView:t,initialize:function(){this.listenTo(i.channel("widget-forms"),"update:filter",this.updateFilter)},updateFilter:function(e){this.setFilter(function(t,n,i){return 0<=t.get("title").toLowerCase().indexOf(e.toLowerCase())})}})}),n("views/widgets/forms/forms",["views/widgets/forms/formsFilter","views/widgets/forms/formsTable","views/widgets/forms/newFormGrid"],function(e,t,n){return Marionette.View.extend({template:"#tmpl-nf-widget-forms",regions:{filter:".filter",content:".content"},ui:{add:".add",cancel:".cancel"},initialize:function(){i.channel("widget-forms").reply("show:newFormsGrid",this.showNewFormGrid,this),i.channel("widget-forms").reply("show:formsTable",this.showFormsTable,this)},onRender:function(){this.getUI("cancel").hide(),this.showChildView("filter",new e),"#new-form"==window.location.hash?(this.getUI("add").hide(),this.getUI("cancel").show(),this.showChildView("content",new n)):this.showChildView("content",new t)},events:{"click @ui.add":"showNewFormGrid","click @ui.cancel":"showFormsTable"},showNewFormGrid:function(){window.location.hash="new-form",this.showChildView("content",new n),i.channel("widget-forms").trigger("change:content"),this.getUI("add").hide(),this.getUI("cancel").show(),this.getChildView("filter").updatePlaceholder("Search Templates")},showFormsTable:function(){console.log(this),window.location.hash="forms",this.showChildView("content",new t),i.channel("widget-forms").trigger("change:content"),this.getUI("cancel").hide(),this.getUI("add").show(),this.getChildView("filter").updatePlaceholder("Search Forms")}})}),n("views/sections/widgets.js",["views/widgets/forms/forms"],function(e){return Marionette.View.extend({template:"#tmpl-nf-widgets",regions:{forms:".widget-forms"},onRender:function(){this.showChildView("forms",new e)}})}),n("views/sections/apps.js",[],function(){return Marionette.View.extend({template:"#tmpl-nf-apps"})}),n("views/sections/memberships.js",[],function(){return Marionette.View.extend({template:"#tmpl-nf-memberships"})}),n("views/dashboardView",["views/sections/widgets.js","views/sections/apps.js","views/sections/memberships.js"],function(e,t,n){return Marionette.View.extend({template:"#tmpl-nf-dashboard",currentView:"widgets",regions:{content:".content"},events:{"click .widgets a":function(t){this.showChildView("content",new e),jQuery("."+this.currentView).find("a").removeClass("active"),t.target.classList.add("active"),this.currentView="widgets"},"click .apps a":function(e){this.showChildView("content",new t),jQuery("."+this.currentView).find("a").removeClass("active"),e.target.classList.add("active"),this.currentView="apps"},"click .memberships a":function(e){this.showChildView("content",new n),jQuery("."+this.currentView).find("a").removeClass("active"),e.target.classList.add("active"),this.currentView="memberships"}},initialize:function(){switch(window.location.hash){case"#apps":this.currentView="apps";break;case"#memberships":this.currentView="memberships";break;case"#widgets":default:this.currentView="widgets"}i.channel("dashboard").reply("show:widgets",function(){this.showChildView("content",new e),jQuery("nav.sections a.active").removeClass("active"),jQuery("nav.sections .widgets a").addClass("active"),this.currentView="widgets"},this),i.channel("dashboard").reply("show:apps",function(){this.showChildView("content",new t),jQuery("nav.sections a.active").removeClass("active"),jQuery("nav.sections .apps a").addClass("active"),this.currentView="apps"},this)},onRender:function(){switch(window.location.hash){case"#apps":var i=new t;break;case"#memberships":var i=new n;break;case"#widgets":default:var i=new e}if(this.showChildView("content",i),void 0!==nfAdmin.formTelemetry&&1==nfAdmin.formTelemetry){console.log("got here");var o={action:"nf_form_telemetry",security:nfAdmin.ajaxNonce};jQuery.post(ajaxurl,o)}},templateContext:function(){var e=this;return{renderNav:function(){var t=document.createElement("div");return _.each(nfDashItems,function(n){var i=document.createElement("li"),o=document.createElement("a");o.href="#"+n.slug,e.currentView==n.slug&&o.classList.add("active"),o.innerHTML=n.niceName,i.classList.add(n.slug),i.appendChild(o),t.appendChild(i)}),t.innerHTML}}}})});var i=Backbone.Radio;jQuery(document).ready(function(e){t(["controllers/formsController","views/dashboardView"],function(t,n){(new(Marionette.Application.extend({region:"#ninja-forms-dashboard",controllers:{},initialize:function(e){var t=this;Marionette.Renderer.render=function(e,n){var e=t.template(e);return e(n)}},onStart:function(){this.showView(new n),this.controllers.forms=new t},template:function(t){return _.template(e(t).html(),{evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"})}}))).start()})}),jQuery('a[href="admin.php?page=ninja-forms#new-form"]').on("click",function(){event.preventDefault(),window.location.hash="new-form",i.channel("dashboard").request("show:widgets"),i.channel("widget-forms").request("show:newFormsGrid")}),jQuery('a[href="admin.php?page=ninja-forms#apps"]').on("click",function(){event.preventDefault(),window.location.hash="apps",i.channel("dashboard").request("show:apps")}),jQuery('a[href="admin.php?page=ninja-forms"]').on("click",function(e){e.preventDefault(),window.location.hash="forms",i.channel("dashboard").request("show:widgets"),i.channel("widget-forms").request("show:formsTable")}),n("main",function(){})}();
//# sourceMappingURL=almond.build.js.map
//# sourceMappingURL=dashboard.min.js.map
